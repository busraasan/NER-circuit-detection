/home/basan/fmvalid/lib/python3.11/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.00it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.97it/s]
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model gemma-2b into HookedTransformer
/home/basan/scratch/subtasks_pos/subtasks_of_language/notebooks/run_advanced_pos_circuit.py:157: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ans_tokens = torch.stack([torch.tensor((ans_clean))]).to(device)
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 1 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 2 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 3 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 4 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 5 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 6 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 7 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 8 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 9 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 10 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 11 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 12 samplescorr_loss 8.569700241088867 patched_loss: 9.26534652709961 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 10.049839973449707 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 23.0236873626709 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.569129943847656 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 7.920469760894775 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 11.399337768554688 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.167877197265625 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 8.944158554077148 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 7.98190450668335 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.337424278259277 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 10.105538368225098 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.540982246398926 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 13.523028373718262 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.043964385986328 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.680500984191895 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 10.120855331420898 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 8.25308609008789 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.676031112670898 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.878192901611328 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 7.7453532218933105 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 9.138222694396973 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
corr_loss 8.569700241088867 patched_loss: 8.985974311828613 clean_loss: 8.569389343261719 denom: -0.0003108978271484375
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 13 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 14 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 15 samplescorr_loss 7.921245574951172 patched_loss: 19.428796768188477 clean_loss: 7.917203903198242 denom: -0.0040416717529296875
corr_loss 7.921245574951172 patched_loss: 12.149130821228027 clean_loss: 7.917203903198242 denom: -0.0040416717529296875
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 16 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 17 samplescorr_loss 7.554368019104004 patched_loss: 48.552921295166016 clean_loss: 7.527035713195801 denom: -0.027332305908203125
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 18 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 19 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 20 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 21 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 22 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 23 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 24 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 25 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 26 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 27 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 28 samplescorr_loss 7.406845569610596 patched_loss: 49.72657012939453 clean_loss: 7.424927234649658 denom: 0.0180816650390625
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 29 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 30 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 31 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 32 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 33 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 34 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 35 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 36 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 37 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 38 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 39 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 40 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 41 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 42 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 43 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 44 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 45 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 46 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 47 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:24
Completed 48 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:24
Completed 49 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 50 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 51 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 52 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 53 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 54 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 55 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 56 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 57 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 58 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 59 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 60 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 61 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 62 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 63 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 64 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 65 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 66 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 67 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 68 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 69 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 70 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 71 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 72 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 73 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 74 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 75 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 76 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 77 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 78 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 79 samplesWorking... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:23
Completed 80 samplesOUTPUT tensor([[ 2.9705e+03, -8.7101e+02,  6.1123e+03,  1.8922e+02, -6.7906e+02,
          6.0912e+04,  4.3744e+03, -2.8020e+03],
        [ 1.5988e+02,  8.9467e+02,  1.2056e+04, -6.6885e+01,  4.4999e+02,
          9.7579e+01, -1.4885e+02, -2.2710e+01],
        [-5.2441e+01,  2.0271e+02,  2.5292e+03,  2.0327e+00,  1.0089e+02,
         -1.9695e+02,  2.1822e+02, -2.3325e+02],
        [-1.6662e+02,  1.5172e+02,  1.9264e+02, -6.4405e+01, -1.1774e+02,
         -7.9151e+01,  2.7880e+02,  8.1661e+01],
        [-2.0546e+02, -7.4581e+01, -2.3580e+02,  1.5397e+03, -1.3130e+01,
         -7.9782e+01,  7.9392e+01,  2.0509e+02],
        [ 1.1973e+03,  4.0257e+02,  3.4416e+01, -2.1034e+00,  7.2991e+01,
         -3.7712e+02, -2.6748e+02,  3.8636e+01],
        [ 4.2188e+01, -1.5122e+02, -8.7620e+01,  1.3929e+02, -2.0859e+02,
         -7.9226e+01,  6.5809e+01, -3.1542e+02],
        [-6.7387e+01, -5.9058e+01,  1.3590e+02,  3.6921e+01,  3.3169e+01,
          2.5086e+02, -1.7316e+02, -1.6651e+02],
        [ 2.8304e+01, -2.6284e+02,  2.9181e+02,  2.6645e+01, -4.6929e+01,
         -2.9663e+00, -3.6333e+02, -4.2900e+01],
        [-1.9343e+01, -6.7832e+01, -1.5526e+02,  8.7711e+01,  4.1321e+02,
         -9.6888e+01,  8.8902e+01, -1.1151e+02],
        [ 2.4720e+02,  9.9699e+01,  1.0775e+02,  1.4294e+02, -3.3892e+02,
          6.6384e+02, -9.7254e-01, -2.0075e+02],
        [ 1.3647e+02,  3.3414e+02,  7.3542e+02, -1.9157e+02, -2.5797e+03,
          4.4214e+02,  3.3755e+03,  1.0316e+02],
        [ 5.0644e+02,  1.7008e+02, -1.3680e+02,  7.1706e+01,  6.5027e+01,
          1.5495e+02, -2.8354e+00, -4.5098e+02],
        [ 3.7446e+01, -6.8614e+01,  6.0404e+02,  8.7197e+02, -2.9709e+02,
          1.1005e+02,  7.7027e+02,  3.8800e+02],
        [ 6.6912e+03,  4.0283e+03,  2.1254e+04,  2.1383e+03,  4.6592e+03,
          6.3540e+01,  6.4831e+03,  8.1199e+02],
        [-9.2896e+02, -1.3242e+03,  2.1384e+02,  4.6566e+03, -3.2190e+01,
         -2.6689e+02, -3.0959e+02, -9.3194e+01],
        [ 5.6372e+03, -3.5498e+03,  4.5447e+02,  6.1268e+01,  2.3842e+03,
          1.5149e+02, -1.9277e+02,  8.5478e+01],
        [-3.8522e+02, -6.5074e+01, -4.2419e+01,  1.3857e+02,  1.7520e+03,
         -2.0333e+02, -3.9634e+02, -7.1269e+02]])
Saving to results/advanced_pos_circuit/tf_loss/pos_gpt_mixed_50_sentences/layer_17_head_none/deneme_datasetpos_gpt_mixed_50_sentences_layer_head_17.npy
